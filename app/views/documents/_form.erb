<%= form_for document, :html => { :multipart => true } do |form| %>
    <%= form.hidden_field :user_id, value: current_user_id %>

    <div class="field">
      <%= form.label :title %><br>
      <%= form.text_field :title %>
    </div>

    <br />

    <% if @edit == nil %>
        <div class="btn-group field">
          <label class="btn btn-warning btn-lg">
            <%= radio_button_tag('document[use_editor]', 'true') %>
            Create new document
          </label>
          <label class="btn btn-warning btn-lg">
            <%= radio_button_tag('document[use_editor]', 'false') %>
            Upload existing document
          </label>
        </div>
    <% end %>

    <% if @edit %>
        <% if @document.content.blank? %>
            <div class="field">
              <%= form.label :doc %><br>
              <%= form.file_field :doc %>
            </div>
        <% else %>
            <div class="field">
              <%= form.text_area :content, :class => "tinymce", :rows => 10, :cols => 120 %>
              <%= tinymce %>
            </div>
        <% end %>
        <br />
    <% else %>
        <div class="field" id="document_upload_field">
          <%= form.label :doc %><br>
          <%= form.file_field :doc %>
        </div>
        <br />
        <div class="field" id="document_editor_field">
          <%= form.text_area :content, :class => "tinymce", :rows => 10, :cols => 120 %>
          <%= tinymce %>

          <%= form.fields_for :document_revisions do |f| %>
            <%= f.label :change_control, "Change control message:" %>
            <%= f.text_field :change_control, :size => 130 %>
          <% end %>

        </div>
        <br />
    <% end %>

    <div class="field">
      <%= radio_button_tag('document[assigned_to_all]', 'true') %>
      <%= label_tag(:assigned_to_all_true, "I want all users to read this document") %>
      <%= radio_button_tag('document[assigned_to_all]', 'false') %>
      <%= label_tag(:assigned_to_all_false, "I want to choose specific users who will read this document") %>
    </div>

    <div class="field" id="user_selection">
      <h2>Assign users to read the document</h2>
      <%= form.select(:readers, @users, {prompt: 'Select any amount of users'}, { :multiple => true, :size => 20 } ) %>
    </div>

    <div class="field">
      <h2>Select users to review the document</h2>
      <%= form.select(:reviews, users, {prompt: 'Select any amount of users'}, { :multiple => true, :size => 20 } ) %>
      <h2>Select users to approve the document</h2>
      <%= form.select(:approvals, users, {prompt: 'Select any amount of users'}, { :multiple => true, :size => 20 } ) %>
    </div>

    <div class="field">
      <%= form.label :document_type_id %><br>
      <%= form.select(:document_type_id, document_types, {:multiple => true, :size => 20}) %>
    </div>

    <br />

    <div class="actions">
      <%= form.submit %>
    </div>
<% end %>
